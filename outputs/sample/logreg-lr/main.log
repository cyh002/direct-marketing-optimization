[2025-07-08 15:08:58,910][__main__][INFO] - Starting main workflow
[2025-07-08 15:09:05,906][__main__][WARNING] - MLflow server https://mlflow.lqoasis-aut0.aisingapore.net/ unreachable: <urlopen error timed out>. Disabling MLflow logging.
[2025-07-08 15:09:05,908][__main__][INFO] - Loading datasets
[2025-07-08 15:09:05,908][DataLoader][INFO] - Loading Excel file from /home/c-hiy/direct-marketing-optimization/data/raw/DataScientist_CaseStudy_Dataset.xlsx
[2025-07-08 15:09:06,348][__main__][INFO] - Created sales data split
[2025-07-08 15:09:06,349][Preprocessor][INFO] - Model split: 775 train clients, 194 test clients
[2025-07-08 15:09:06,371][Preprocessor][INFO] - Saved train/test splits to ./preprocessed
[2025-07-08 15:09:06,371][__main__][INFO] - Created train/test split
[2025-07-08 15:09:06,373][__main__][INFO] - Merged training datasets
[2025-07-08 15:09:06,373][__main__][INFO] - Training dataset shape: (775, 36)
[2025-07-08 15:09:06,418][Preprocessor][INFO] - Dropped due to collinearity: ['Count_CA', 'TransactionsCred_CA', 'TransactionsDeb', 'TransactionsDebCashless_Card', 'TransactionsDeb_CA', 'VolumeCred_CA', 'VolumeDeb', 'VolumeDeb_CA', 'VolumeDeb_PaymentOrder']
[2025-07-08 15:09:06,418][__main__][INFO] - Preprocessing pipeline created
[2025-07-08 15:09:06,419][__main__][INFO] - Processing product CL
[2025-07-08 15:09:06,419][__main__][INFO] - Processing product MF
[2025-07-08 15:09:06,420][__main__][INFO] - Processing product CC
[2025-07-08 15:09:06,421][__main__][INFO] - Training models for CC
[2025-07-08 15:09:06,421][__main__][INFO] - Training models for CL
[2025-07-08 15:09:06,421][PropensityTrainer][INFO] - Starting cross validation with scoring=f1 and 5 folds
[2025-07-08 15:09:06,422][PropensityTrainer][INFO] - Starting cross validation with scoring=f1 and 5 folds
[2025-07-08 15:09:06,424][__main__][INFO] - Training models for MF
[2025-07-08 15:09:06,425][PropensityTrainer][INFO] - Starting cross validation with scoring=f1 and 5 folds
[2025-07-08 15:09:06,677][PropensityTrainer][INFO] - Cross validation completed: train_score=0.5319, test_score=0.5203
[2025-07-08 15:09:06,692][PropensityTrainer][INFO] - Model saved to ./models/propensity/CL/LogisticRegression.joblib
[2025-07-08 15:09:06,693][PropensityTrainer][INFO] - Metadata saved to ./models/propensity/CL/LogisticRegression_metadata.json
[2025-07-08 15:09:06,694][RevenueTrainer][INFO] - Starting cross validation with scoring=neg_root_mean_squared_error and 5 folds
[2025-07-08 15:09:06,706][PropensityTrainer][INFO] - Cross validation completed: train_score=0.4305, test_score=0.3635
[2025-07-08 15:09:06,729][PropensityTrainer][INFO] - Cross validation completed: train_score=0.3775, test_score=0.3036
[2025-07-08 15:09:06,749][PropensityTrainer][INFO] - Model saved to ./models/propensity/CC/LogisticRegression.joblib
[2025-07-08 15:09:06,749][PropensityTrainer][INFO] - Metadata saved to ./models/propensity/CC/LogisticRegression_metadata.json
[2025-07-08 15:09:06,751][RevenueTrainer][INFO] - Starting cross validation with scoring=neg_root_mean_squared_error and 5 folds
[2025-07-08 15:09:06,764][PropensityTrainer][INFO] - Model saved to ./models/propensity/MF/LogisticRegression.joblib
[2025-07-08 15:09:06,764][PropensityTrainer][INFO] - Metadata saved to ./models/propensity/MF/LogisticRegression_metadata.json
[2025-07-08 15:09:06,766][RevenueTrainer][INFO] - Starting cross validation with scoring=neg_root_mean_squared_error and 5 folds
[2025-07-08 15:09:06,866][RevenueTrainer][INFO] - Cross validation completed: train_score=-7.6417, test_score=-7.7609
[2025-07-08 15:09:06,894][RevenueTrainer][INFO] - Model saved to ./models/revenue/CL/LinearRegression.joblib
[2025-07-08 15:09:06,895][RevenueTrainer][INFO] - Metadata saved to ./models/revenue/CL/LinearRegression_metadata.json
[2025-07-08 15:09:06,896][__main__][INFO] - Finished training models for CL
[2025-07-08 15:09:06,934][RevenueTrainer][INFO] - Cross validation completed: train_score=-15.8967, test_score=-13.2933
[2025-07-08 15:09:06,946][RevenueTrainer][INFO] - Cross validation completed: train_score=-6.6716, test_score=-6.5343
[2025-07-08 15:09:06,952][RevenueTrainer][INFO] - Model saved to ./models/revenue/CC/LinearRegression.joblib
[2025-07-08 15:09:06,952][RevenueTrainer][INFO] - Metadata saved to ./models/revenue/CC/LinearRegression_metadata.json
[2025-07-08 15:09:06,954][__main__][INFO] - Finished training models for CC
[2025-07-08 15:09:06,954][RevenueTrainer][INFO] - Model saved to ./models/revenue/MF/LinearRegression.joblib
[2025-07-08 15:09:06,954][RevenueTrainer][INFO] - Metadata saved to ./models/revenue/MF/LinearRegression_metadata.json
[2025-07-08 15:09:06,954][__main__][INFO] - Finished training models for MF
[2025-07-08 15:09:06,954][__main__][INFO] - Starting inference
[2025-07-08 15:09:06,954][__main__][INFO] - Merging datasets for inference
[2025-07-08 15:09:06,957][__main__][INFO] - Running propensity and revenue inference
[2025-07-08 15:09:06,957][ModelLoader][INFO] - Loaded model from models/propensity/CL/LogisticRegression.joblib
[2025-07-08 15:09:06,960][ModelLoader][INFO] - Loaded model from models/propensity/MF/LogisticRegression.joblib
[2025-07-08 15:09:06,963][ModelLoader][INFO] - Loaded model from models/propensity/CC/LogisticRegression.joblib
[2025-07-08 15:09:06,966][ModelLoader][INFO] - Loaded model from models/revenue/CL/LinearRegression.joblib
[2025-07-08 15:09:06,970][ModelLoader][INFO] - Loaded model from models/revenue/MF/LinearRegression.joblib
[2025-07-08 15:09:06,973][ModelLoader][INFO] - Loaded model from models/revenue/CC/LinearRegression.joblib
[2025-07-08 15:09:06,976][__main__][INFO] - Saving inference results
[2025-07-08 15:09:06,979][PropensityInference][INFO] - Saved inference results to /home/c-hiy/direct-marketing-optimization/outputs/2025-07-08/15-08-58/inference/propensity_predictions.csv
[2025-07-08 15:09:06,982][RevenueInference][INFO] - Saved inference results to /home/c-hiy/direct-marketing-optimization/outputs/2025-07-08/15-08-58/inference/revenue_predictions.csv
[2025-07-08 15:09:06,983][__main__][INFO] - Starting optimization
[2025-07-08 15:09:06,983][__main__][INFO] - Running optimization
[2025-07-08 15:09:07,013][__main__][INFO] - Starting evaluation
[2025-07-08 15:09:07,013][__main__][INFO] - Evaluating optimization results
[2025-07-08 15:09:07,013][__main__][INFO] - total_revenue: 693.6240
[2025-07-08 15:09:07,013][__main__][INFO] - revenue_per_contact: 6.9362
[2025-07-08 15:09:07,013][__main__][INFO] - acceptance_rate: 0.7953
[2025-07-08 15:09:07,014][__main__][INFO] - roi: 6.9362
[2025-07-08 15:09:07,014][Evaluator][INFO] - Saved evaluation metrics to /home/c-hiy/direct-marketing-optimization/outputs/2025-07-08/15-08-58/results/evaluation_metrics.csv
[2025-07-08 15:09:07,014][__main__][INFO] - Saving optimized offers
[2025-07-08 15:09:07,015][__main__][INFO] - Saving optimized offers
