[2025-07-07 20:03:34,454][__main__][INFO] - Starting main workflow
[2025-07-07 20:03:34,470][__main__][INFO] - Loading datasets
[2025-07-07 20:03:34,470][DataLoader][INFO] - Loading Excel file from /home/c-hiy/direct-marketing-optimization/data/raw/DataScientist_CaseStudy_Dataset.xlsx
[2025-07-07 20:03:34,762][__main__][INFO] - Created sales data split
[2025-07-07 20:03:34,763][Preprocessor][INFO] - Model split: 775 train clients, 194 test clients
[2025-07-07 20:03:34,780][Preprocessor][INFO] - Saved train/test splits to ./preprocessed
[2025-07-07 20:03:34,780][__main__][INFO] - Created train/test split
[2025-07-07 20:03:34,782][__main__][INFO] - Merged training datasets
[2025-07-07 20:03:34,782][__main__][INFO] - Training dataset shape: (775, 36)
[2025-07-07 20:03:34,782][__main__][INFO] - Preprocessing pipeline created
[2025-07-07 20:03:34,783][__main__][INFO] - Processing product CL
[2025-07-07 20:03:34,784][__main__][INFO] - Processing product MF
[2025-07-07 20:03:34,785][__main__][INFO] - Processing product CC
[2025-07-07 20:03:34,786][__main__][INFO] - Training models for CC
[2025-07-07 20:03:34,787][__main__][INFO] - Training models for CL
[2025-07-07 20:03:34,788][__main__][INFO] - Training models for MF
[2025-07-07 20:03:35,018][PropensityTrainer][INFO] - Starting cross validation with scoring=f1 and 5 folds
[2025-07-07 20:03:35,020][PropensityTrainer][INFO] - Starting cross validation with scoring=f1 and 5 folds
[2025-07-07 20:03:35,021][PropensityTrainer][INFO] - Starting cross validation with scoring=f1 and 5 folds
[2025-07-07 20:03:35,279][PropensityTrainer][INFO] - Cross validation completed: train_score=0.4842, test_score=0.4009
[2025-07-07 20:03:35,306][PropensityTrainer][INFO] - Cross validation completed: train_score=0.3620, test_score=0.2788
[2025-07-07 20:03:35,350][PropensityTrainer][INFO] - Cross validation completed: train_score=0.2988, test_score=0.1940
[2025-07-07 20:03:38,495][PropensityTrainer][INFO] - Model saved to ./models/propensity/CL/LogisticRegression.joblib
[2025-07-07 20:03:38,496][PropensityTrainer][INFO] - Metadata saved to ./models/propensity/CL/LogisticRegression_metadata.json
[2025-07-07 20:03:38,604][RevenueTrainer][INFO] - Starting cross validation with scoring=neg_root_mean_squared_error and 5 folds
[2025-07-07 20:03:38,765][PropensityTrainer][INFO] - Model saved to ./models/propensity/CC/LogisticRegression.joblib
[2025-07-07 20:03:38,765][PropensityTrainer][INFO] - Metadata saved to ./models/propensity/CC/LogisticRegression_metadata.json
[2025-07-07 20:03:38,789][PropensityTrainer][INFO] - Model saved to ./models/propensity/MF/LogisticRegression.joblib
[2025-07-07 20:03:38,789][PropensityTrainer][INFO] - Metadata saved to ./models/propensity/MF/LogisticRegression_metadata.json
[2025-07-07 20:03:38,794][RevenueTrainer][INFO] - Starting cross validation with scoring=neg_root_mean_squared_error and 5 folds
[2025-07-07 20:03:38,819][RevenueTrainer][INFO] - Starting cross validation with scoring=neg_root_mean_squared_error and 5 folds
[2025-07-07 20:03:39,730][RevenueTrainer][INFO] - Cross validation completed: train_score=-4.0715, test_score=-8.1783
[2025-07-07 20:03:39,826][RevenueTrainer][INFO] - Cross validation completed: train_score=-3.1181, test_score=-17.8691
[2025-07-07 20:03:39,859][RevenueTrainer][INFO] - Cross validation completed: train_score=-2.7505, test_score=-7.3593
[2025-07-07 20:03:41,169][RevenueTrainer][INFO] - Model saved to ./models/revenue/CL/GradientBoostingRegressor.joblib
[2025-07-07 20:03:41,169][RevenueTrainer][INFO] - Metadata saved to ./models/revenue/CL/GradientBoostingRegressor_metadata.json
[2025-07-07 20:03:41,176][__main__][INFO] - Finished training models for CL
[2025-07-07 20:03:41,479][RevenueTrainer][INFO] - Model saved to ./models/revenue/CC/GradientBoostingRegressor.joblib
[2025-07-07 20:03:41,480][RevenueTrainer][INFO] - Model saved to ./models/revenue/MF/GradientBoostingRegressor.joblib
[2025-07-07 20:03:41,480][RevenueTrainer][INFO] - Metadata saved to ./models/revenue/CC/GradientBoostingRegressor_metadata.json
[2025-07-07 20:03:41,480][RevenueTrainer][INFO] - Metadata saved to ./models/revenue/MF/GradientBoostingRegressor_metadata.json
[2025-07-07 20:03:41,493][__main__][INFO] - Finished training models for CC
[2025-07-07 20:03:41,494][__main__][INFO] - Finished training models for MF
[2025-07-07 20:03:41,494][__main__][INFO] - Starting inference
[2025-07-07 20:03:41,494][__main__][INFO] - Merging datasets for inference
[2025-07-07 20:03:41,497][__main__][INFO] - Running propensity and revenue inference
[2025-07-07 20:03:41,498][ModelLoader][INFO] - Loaded model from models/propensity/CL/LogisticRegression.joblib
[2025-07-07 20:03:41,501][ModelLoader][INFO] - Loaded model from models/propensity/MF/LogisticRegression.joblib
[2025-07-07 20:03:41,504][ModelLoader][INFO] - Loaded model from models/propensity/CC/LogisticRegression.joblib
[2025-07-07 20:03:41,507][ModelLoader][INFO] - Loaded model from models/revenue/CL/GradientBoostingRegressor.joblib
[2025-07-07 20:03:41,511][ModelLoader][INFO] - Loaded model from models/revenue/MF/GradientBoostingRegressor.joblib
[2025-07-07 20:03:41,516][ModelLoader][INFO] - Loaded model from models/revenue/CC/GradientBoostingRegressor.joblib
[2025-07-07 20:03:41,520][__main__][INFO] - Saving inference results
[2025-07-07 20:03:41,523][PropensityInference][INFO] - Saved inference results to /home/c-hiy/direct-marketing-optimization/outputs/2025-07-07/20-03-34/inference/propensity_predictions.csv
[2025-07-07 20:03:41,526][RevenueInference][INFO] - Saved inference results to /home/c-hiy/direct-marketing-optimization/outputs/2025-07-07/20-03-34/inference/revenue_predictions.csv
[2025-07-07 20:03:41,526][__main__][INFO] - Starting optimization
[2025-07-07 20:03:41,526][__main__][INFO] - Running optimization
[2025-07-07 20:03:41,558][__main__][INFO] - Starting evaluation
[2025-07-07 20:03:41,558][__main__][INFO] - Evaluating optimization results
[2025-07-07 20:03:41,558][__main__][INFO] - total_revenue: 1150.4971
[2025-07-07 20:03:41,558][__main__][INFO] - revenue_per_contact: 11.5050
[2025-07-07 20:03:41,558][__main__][INFO] - acceptance_rate: 0.6321
[2025-07-07 20:03:41,558][__main__][INFO] - roi: 11.5050
[2025-07-07 20:03:41,559][Evaluator][INFO] - Saved evaluation metrics to /home/c-hiy/direct-marketing-optimization/outputs/2025-07-07/20-03-34/results/evaluation_metrics.csv
[2025-07-07 20:03:41,559][__main__][INFO] - Saving optimized offers
[2025-07-07 20:03:41,559][__main__][INFO] - Saving optimized offers
